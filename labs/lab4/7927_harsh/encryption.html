<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Encryption/Decryption Performance</title></head><body><h2>Encrypt/Decrypt To-Do Items</h2><button onclick="encryptData()">Encrypt</button><button onclick="decryptData()">Decrypt</button><p><strong>Encryption Time:</strong> <span id="encryptionTime"></span> ms</p><p><strong>Decryption Time:</strong> <span id="decryptionTime"></span> ms</p><p><strong>Encrypted Data:</strong> <span id="encryptedData"></span></p><p><strong>Decrypted Data:</strong> <span id="decryptedData"></span></p><script>    const status = ["In Progress", "Completed", "Other"];    const tasks = [        "Finish the monthly report",        "Prepare presentation slides",        "Review code changes",        "Write documentation",        "Attend team meeting",        "Test new feature",        "Fix bugs from review",        "Complete project plan",        "Update client on progress",        "Conduct code review session",        "Organize project files",        "Write user manual",        "Research new software tools",        "Implement feedback from team",        "Optimize performance issues",        "Update project roadmap",        "Schedule meeting with client",        "Create test cases for new feature",        "Prepare financial report",        "Submit time-off request",        "Evaluate team performance",        "Run software simulations",        "Implement security patches",        "Organize team-building event",        "Prepare meeting agenda",        "Review technical documentation",        "Update internal knowledge base",        "Deploy new software version",        "Track project milestones",        "Review legal documents",        "Analyze user feedback",        "Check system backups",        "Prepare budget forecast",        "Host a training session",        "Organize feedback from users",        "Draft a proposal for a new project",        "Perform database maintenance",        "Schedule code deployment",        "Collaborate on project deliverables",        "Prepare project timeline",        "Organize marketing materials",        "Perform system integration tests"    ];    const dbName = "Lab4DB";    const storeName = "EncryptedTodoList";    let encryptedArray = null;    let key = null;    let iv = null;    // Generate a cryptographic key    async function generateKey() {        key = await crypto.subtle.generateKey(            { name: "AES-GCM", length: 256 },            true,            ["encrypt", "decrypt"]        );        iv = crypto.getRandomValues(new Uint8Array(12)); // Initialization vector    }    // Encrypt the data (JSON array)    async function encryptData() {        if (!key) await generateKey();        const start = performance.now();  // Start measuring time        //Setup IndexedDB        let request = indexedDB.open(dbName, 1);        request.onupgradeneeded = function (event) {            let db = event.target.result;            if (!db.objectStoreNames.contains(storeName)) {                let objectStore = db.createObjectStore(storeName, { keyPath: "id" });                objectStore.createIndex("id", "id", { unique: false });                objectStore.createIndex("status", "status", { unique: false });            }        };        request.onsuccess = async function (event) {            let db = event.target.result;            // Generate 1000 Objects            const encryptedObjectList = [];            for (let i = 0; i < 1000; i++) {                const object = {                    id: i,                    task: `${tasks[Math.floor(Math.random() * tasks.length)]}`,                    status: `${status[Math.floor(Math.random() * status.length)]}`,                    dueDate: new Date(Date.now() + Math.floor(Math.random() * 1000000000)).toISOString().split('T')[0]                };                //Encrypt objects                const encoder = new TextEncoder();                const encodedData = encoder.encode(JSON.stringify(object));                const encryptedObject = await crypto.subtle.encrypt(                    { name: "AES-GCM", iv: iv },                    key,                    encodedData                )                //Add it to the encrypted data                encryptedObjectList.push({"id": object.id, "encrypted": encryptedObject})            }            // Add encrypted data to database            let transaction = db.transaction(storeName, "readonly");            let objectStore = transaction.objectStore(storeName);            let countRequest = objectStore.count();            countRequest.onsuccess = async function () {                // If no data, insert new data                if (countRequest.result === 0) {                    let writeTransaction = db.transaction(storeName, "readwrite");                    let writeObjectStore = writeTransaction.objectStore(storeName);                    encryptedObjectList.forEach(encryptedObject => {                        writeObjectStore.add(encryptedObject);                      })                    let htmlEncryptedDataList = document.getElementById('encryptedData');                    htmlEncryptedDataList.innerHTML = "";                    //Display encrypted objects                    encryptedObjectList.forEach(encryptedObject => {                        let item = document.createElement('li');                        item.textContent = new Uint8Array(encryptedObject.encrypted).toString();  // Convert Uint8Array to string                        htmlEncryptedDataList.appendChild(item);                    })                    const end = performance.now();                    document.getElementById('encryptionTime').textContent = (end - start).toFixed(2);                } else {                    console.log("Objects already exist, skipping insertion.");                }            };            countRequest.onerror = function (event) {                console.error("Error counting objects:", event);            };        };        request.onerror = function (event) {            console.error("Error opening IndexedDB:", event);        };    }    // Decrypt the data    async function decryptData() {        const start = performance.now();  // Start measuring time        let request = indexedDB.open(dbName, 1);        request.onsuccess = function (event) {            let db = event.target.result;            let transaction = db.transaction(storeName, "readonly");            let objectStore = transaction.objectStore(storeName);            const decryptedData = [];            let request = objectStore.getAll();            request.onsuccess = async function (event) {                let data = event.target.result;                data.forEach(async task => {                    //Decrypt data from IndexedDB                    const decryptedArrayBuffer = await crypto.subtle.decrypt(                        { name: "AES-GCM", iv: iv },                        key,                        task.encrypted                    );                    const decoder = new TextDecoder();                    const decryptedObject = decoder.decode(decryptedArrayBuffer);                    decryptedData.push(decryptedObject)                    document.getElementById('decryptedData').textContent = decryptedData;                });                const end = performance.now();  // End measuring time                document.getElementById('decryptionTime').textContent = (end - start).toFixed(2);            }             transaction.onerror = function (event) {             console.error("Error updating statuses:", event);            };        };    }</script></body></html>